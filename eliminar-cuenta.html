<!doctype html>
<html lang="es-AR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow" />
  <title>Eliminar cuenta | Tu Kiosquito</title>
  <style>
    body { font-family: system-ui, Arial; margin: 0; padding: 24px; }
    .wrap { max-width: 860px; margin: 0 auto; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; }
    label { display: block; margin-top: 12px; font-weight: 600; }
    input { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #ccc; }
    button { margin-top: 14px; padding: 10px 14px; border-radius: 10px; border: 0; cursor: pointer; }
    .danger { background: #c62828; color: white; }
    .muted { opacity: .85; font-size: .95rem; }
    .warn {
      margin: 14px 0;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #f0ad4e;
      background: #fff8e1;
      color: #5a4100;
    }
    .info {
      margin: 14px 0;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #90caf9;
      background: #e3f2fd;
      color: #0d47a1;
    }
    .msg { margin-top: 12px; padding: 10px; border-radius: 10px; }
    .ok { background: #e8f5e9; border: 1px solid #a5d6a7; }
    .err { background: #ffebee; border: 1px solid #ef9a9a; }
    h1 { margin-top: 0; }
    h2 { margin: 18px 0 8px; font-size: 1.1rem; }
    ul, ol { margin: 8px 0 0 22px; }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    a { color: inherit; }
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    @media (min-width: 780px) {
      .grid { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Eliminar cuenta – Tu Kiosquito</h1>

    <p class="muted">
      Esta página pertenece a <strong>Tu Kiosquito</strong> (Android) y te permite solicitar la eliminación de tu cuenta
      y los datos asociados. Este enlace puede mostrarse en Google Play Store.
    </p>

    <div class="warn">
      <strong>Importante:</strong> esta acción es <strong>irreversible</strong>. Si tu cuenta tenía una <strong>suscripción activa</strong>
      o acceso a un <strong>plan pago</strong>, al eliminar la cuenta <strong>perderás el acceso</strong> asociado a esa cuenta.
      <br/>
      <span class="muted">
        La cancelación de cobros depende del proveedor de pagos. Si corresponde, gestioná tu suscripción desde Google Play u otro medio.
      </span>
    </div>

    <!-- =========================
         Formulario de eliminación directa (backend)
         ========================= -->
    <div class="card" aria-label="Formulario de eliminación de cuenta">
      <h2>Eliminar cuenta ahora</h2>
      <p class="muted">
        Ingresá el correo y la contraseña de tu cuenta de <strong>Tu Kiosquito</strong> para eliminarla.
      </p>

      <label for="email">Correo</label>
      <input id="email" type="email" autocomplete="email" placeholder="tuemail@ejemplo.com" />

      <label for="password">Contraseña</label>
      <input id="password" type="password" autocomplete="current-password" placeholder="********" />

      <button class="danger" id="btn">Eliminar mi cuenta</button>

      <div id="msg" class="msg" style="display:none;"></div>

    
    </div>

    <!-- =========================
         Lo que pide Play Console (pasos + datos + retención)
         ========================= -->
    <div class="card" style="margin-top:16px;">
      <h2>Pasos para solicitar la eliminación</h2>
      <ol>
        <li>Usá el formulario de arriba ingresando tu <strong>correo</strong> y <strong>contraseña</strong>.</li>
        <li>Confirmá la acción cuando el navegador te lo solicite.</li>
        <li>Si las credenciales son correctas, la cuenta se elimina y vas a ver una confirmación en pantalla.</li>
      </ol>

      <div class="info">
        <strong>Alternativa si no podés acceder:</strong>
        escribí a <a href="mailto:leonardoj.lujan03@gmail.com?subject=Solicitud%20de%20eliminaci%C3%B3n%20de%20cuenta%20-%20Tu%20Kiosquito">leonardoj.lujan03@gmail.com</a>
        con el asunto <code>Solicitud de eliminación de cuenta - Tu Kiosquito</code> e indicando el correo de tu cuenta.
      </div>

      <h2>Datos que se eliminarán</h2>
      <p class="muted">Al aprobarse la solicitud, se elimina la cuenta y los datos asociados, incluyendo:</p>

      <div class="grid">
        <div class="card" style="margin:0;">
          <strong>Datos de cuenta y perfil</strong>
          <ul>
            <li>Correo electrónico</li>
            <li>Nombre de usuario</li>
            <li>Nombre y apellido</li>
            <li>Teléfono</li>
            <li>Ciudad, provincia y país (si fueron provistos)</li>
          </ul>
        </div>

        <div class="card" style="margin:0;">
          <strong>Datos de plan / acceso</strong>
          <ul>
            <li>Plan asociado a la cuenta</li>
            <li>Acceso habilitado por suscripción/plan pago para esa cuenta</li>
          </ul>
        </div>
      </div>

      <p class="muted" style="margin-top:12px;">
        Nota: la contraseña no se guarda en texto plano; se almacena hasheada. Al eliminar la cuenta se elimina el registro completo.
      </p>

      <h2>Datos que podrían conservarse y retención</h2>
      <p class="muted">
        En general, al eliminar la cuenta no se conservan datos personales. No obstante, podrían conservarse por un período limitado
        <strong>registros técnicos mínimos</strong> (por ejemplo logs del servidor) por motivos de seguridad y prevención de fraude.
      </p>
      <ul>
        <li><strong>Retención adicional (si aplica):</strong> hasta <strong>30 días</strong> para registros técnicos mínimos.</li>
      </ul>

      <h2>Contacto del desarrollador</h2>
      <p>
        Desarrollador: <strong>Tu Kiosquito</strong><br/>
        Contacto: <a href="mailto:leonardoj.lujan03@gmail.com">leonardoj.lujan03@gmail.com</a>
      </p>
      <p class="muted">Última actualización: 2026-01-31</p>
    </div>
  </div>

  <script>
    // Backend real que elimina la cuenta (según lo que pasaste)
    const ENDPOINT = "https://brave-ange-ljlargtech-9ea76f4d.koyeb.app/api/users/delete-account/";

    // Mostrar el endpoint en la UI
    document.getElementById("endpointText").textContent = ENDPOINT;

    const btn = document.getElementById("btn");
    const email = document.getElementById("email");
    const password = document.getElementById("password");
    const msg = document.getElementById("msg");

    function showMessage(text, ok=true) {
      msg.style.display = "block";
      msg.className = "msg " + (ok ? "ok" : "err");
      msg.textContent = text;
    }

    btn.addEventListener("click", async () => {
      const e = (email.value || "").trim().toLowerCase();
      const p = password.value || "";

      if (!e || !p) {
        showMessage("Completá correo y contraseña.", false);
        return;
      }

      const confirm1 = confirm(
        "¿Seguro que querés eliminar tu cuenta? Esta acción es irreversible y perderás el acceso si tenías suscripción/plan pago."
      );
      if (!confirm1) return;

      btn.disabled = true;
      btn.textContent = "Eliminando...";

      try {
        const res = await fetch(ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email: e, password: p })
        });

        const data = await res.json().catch(() => ({}));

        if (!res.ok) {
          showMessage(data.detail || `Error (${res.status})`, false);
          return;
        }

        showMessage(
          data.detail || "Cuenta eliminada correctamente. Si tenías una suscripción activa, perderás el acceso asociado a esa cuenta.",
          true
        );
        password.value = "";
      } catch (err) {
        showMessage(
          "No se pudo conectar con el servidor. Revisá la URL del backend y la configuración de CORS/HTTPS.",
          false
        );
      } finally {
        btn.disabled = false;
        btn.textContent = "Eliminar mi cuenta";
      }
    });
  </script>
</body>
</html>
